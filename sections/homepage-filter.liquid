{% assign results = collections.all %}
{% assign enable_filtering = true %}
<form
  id="desktopfilterform"
>
  {%- for filter in results.filters -%}
    {%- assign total_active_values = total_active_values | plus: filter.active_values.size -%}
    {% case filter.type %}
      {% when 'boolean', 'list' %}
        <details
          data-index="{{ forloop.index }}"
        >
          <summary>
            <span>{{- filter.label | escape }} </span>
          </summary>
          <div
            id="Facet"
          >
            <div class="wrapper">
              {%- for value in filter.values -%}
                <label
                  for="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}"
                  class="facet-checkbox{% if value.count == 0 and value.active == false %} facet-checkbox--disabled{% endif %}"
                >
                  <input
                    type="checkbox"
                    name="{{ value.param_name }}"
                    value="{{ value.value }}"
                    id="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}"
                    {% if value.active %}
                      checked
                    {% endif %}
                    {% if value.count == 0 and value.active == false %}
                      disabled
                    {% endif %}
                  >

                  <span aria-hidden="true">{{ value.label | escape }} ({{ value.count }})</span>
                  <span class="visually-hidden">
                    {{- value.label | escape }} (
                    {%- if value.count == 1 -%}
                      {{- 'products.facets.product_count_simple.one' | t: count: value.count -}}
                    {%- else -%}
                      {{- 'products.facets.product_count_simple.other' | t: count: value.count -}}
                    {%- endif -%}
                    )
                  </span>
                </label>
              {%- endfor -%}
            </div>
          </div>
        </details>
      {% when 'price_range' %}
        {% liquid
          assign currencies_using_comma_decimals = 'ANG,ARS,BRL,BYN,BYR,CLF,CLP,COP,CRC,CZK,DKK,EUR,HRK,HUF,IDR,ISK,MZN,NOK,PLN,RON,RUB,SEK,TRY,UYU,VES,VND' | split: ','
          assign uses_comma_decimals = false
          if currencies_using_comma_decimals contains cart.currency.iso_code
            assign uses_comma_decimals = true
          endif
        %}
        <details
          id="Details-{{ forloop.index }}-{{ section.id }}"
          class="{% if filter_type == 'horizontal' %}disclosure-has-popup facets__disclosure{% else %} facets__disclosure-vertical{% endif %} js-filter"
          data-index="{{ forloop.index }}"
          {% if filter_type == 'vertical' and forloop.index == 1 %}
            open
          {% endif %}
        >
          <summary>
            <div>
              <span> Budget of {{ filter.label | escape }}</span>
            </div>
          </summary>
          <div
            id="Facet-{{ forloop.index }}-{{ section.id }}"
          >
            <div class="{% if filter_type == 'horizontal' %}facets__header{% else %}facets__header-vertical{% endif %}">
              {%- assign max_price_amount = filter.range_max | money | strip_html | escape -%}
            </div>
            <price-range class="facets__price">
              {%- if filter_type != 'vertical' -%}
                <span class="field-currency">{{ cart.currency.symbol }}</span>
              {%- endif -%}
              <div class="field">
                <input
                  class="field__input"
                  name="{{ filter.max_value.param_name }}"
                  id="Filter-{{ filter.label | escape }}-LTE"
                  type="number"
                  min="0"
                >
              </div>
            </price-range>
          </div>
        </details>
    {% endcase %}
  {%- endfor -%}
  <input type="submit" value="search">
</form>

{% javascript %}
  const form = document.querySelector('#desktopfilterform').addEventListener('submit', (e) => {
    e.preventDefault();
    const formdata = new FormData(document.querySelector('#desktopfilterform'));
    let searchparams = '?';
    for (const [key, value] of formdata) {
      searchparams += `${key}=${value}&`;
    }
    window.location.href = `/collections/all${searchparams}`;
  });
{% endjavascript %}
{% schema %}
{
  "name": "Filter",
  "tag": "section",
  "class": "section",
  "settings": [],

  "presets": [
    {
      "name": "Filter",
      "category": "home"
    }
  ]
}
{% endschema %}
